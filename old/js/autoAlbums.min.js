/* ======================================================= 
 * Auto Albums - Multi Level Responsive Grid
 * By David Blanco
 *
 * Contact: http://codecanyon.net/user/davidbo90
 *
 * Created: July 23, 2013
 *
 * Copyright (c) 2013, David Blanco. All rights reserved.
 * Released under CodeCanyon License http://codecanyon.net/
 *
 * Note: Script based in jQuery Masonry v2.1.07 made by David DeSandro http://masonry.desandro.com/ (under MIT)
 *
 * ======================================================= */

(function(){function e(){}function t(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function n(e){return function(){return this[e].apply(this,arguments)}}var r=e.prototype,i=this,s=i.EventEmitter;r.getListeners=function(e){var t,n,r=this._getEvents();if("object"==typeof e){t={};for(n in r)r.hasOwnProperty(n)&&e.test(n)&&(t[n]=r[n])}else t=r[e]||(r[e]=[]);return t},r.flattenListeners=function(e){var t,n=[];for(t=0;e.length>t;t+=1)n.push(e[t].listener);return n},r.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&(t={},t[e]=n),t||n},r.addListener=function(e,n){var r,i=this.getListenersAsObject(e),s="object"==typeof n;for(r in i)i.hasOwnProperty(r)&&-1===t(i[r],n)&&i[r].push(s?n:{listener:n,once:!1});return this},r.on=n("addListener"),r.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},r.once=n("addOnceListener"),r.defineEvent=function(e){return this.getListeners(e),this},r.defineEvents=function(e){for(var t=0;e.length>t;t+=1)this.defineEvent(e[t]);return this},r.removeListener=function(e,n){var r,i,s=this.getListenersAsObject(e);for(i in s)s.hasOwnProperty(i)&&(r=t(s[i],n),-1!==r&&s[i].splice(r,1));return this},r.off=n("removeListener"),r.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},r.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},r.manipulateListeners=function(e,t,n){var r,i,s=e?this.removeListener:this.addListener,o=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=n.length;r--;)s.call(this,t,n[r]);else for(r in t)t.hasOwnProperty(r)&&(i=t[r])&&("function"==typeof i?s.call(this,r,i):o.call(this,r,i));return this},r.removeEvent=function(e){var t,n=typeof e,r=this._getEvents();if("string"===n)delete r[e];else if("object"===n)for(t in r)r.hasOwnProperty(t)&&e.test(t)&&delete r[t];else delete this._events;return this},r.removeAllListeners=n("removeEvent"),r.emitEvent=function(e,t){var n,r,i,s,o=this.getListenersAsObject(e);for(i in o)if(o.hasOwnProperty(i))for(r=o[i].length;r--;)n=o[i][r],n.once===!0&&this.removeListener(e,n.listener),s=n.listener.apply(this,t||[]),s===this._getOnceReturnValue()&&this.removeListener(e,n.listener);return this},r.trigger=n("emitEvent"),r.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},r.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},r._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},r._getEvents=function(){return this._events||(this._events={})},e.noConflict=function(){return i.EventEmitter=s,e},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return e}):"object"==typeof module&&module.exports?module.exports=e:this.EventEmitter=e}).call(this),function(e){function t(t){var n=e.event;return n.target=n.target||n.srcElement||t,n}var n=document.documentElement,r=function(){};n.addEventListener?r=function(e,t,n){e.addEventListener(t,n,!1)}:n.attachEvent&&(r=function(e,n,r){e[n+r]=r.handleEvent?function(){var n=t(e);r.handleEvent.call(r,n)}:function(){var n=t(e);r.call(e,n)},e.attachEvent("on"+n,e[n+r])});var i=function(){};n.removeEventListener?i=function(e,t,n){e.removeEventListener(t,n,!1)}:n.detachEvent&&(i=function(e,t,n){e.detachEvent("on"+t,e[t+n]);try{delete e[t+n]}catch(r){e[t+n]=void 0}});var s={bind:r,unbind:i};"function"==typeof define&&define.amd?define("eventie/eventie",s):e.eventie=s}(this),function(e,t){"function"==typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],function(n,r){return t(e,n,r)}):"object"==typeof exports?module.exports=t(e,require("eventEmitter"),require("eventie")):e.imagesLoaded=t(e,e.EventEmitter,e.eventie)}(this,function(e,t,n){function r(e,t){for(var n in t)e[n]=t[n];return e}function i(e){return"[object Array]"===h.call(e)}function s(e){var t=[];if(i(e))t=e;else if("number"==typeof e.length)for(var n=0,r=e.length;r>n;n++)t.push(e[n]);else t.push(e);return t}function o(e,t,n){if(!(this instanceof o))return new o(e,t);"string"==typeof e&&(e=document.querySelectorAll(e)),this.elements=s(e),this.options=r({},this.options),"function"==typeof t?n=t:r(this.options,t),n&&this.on("always",n),this.getImages(),f&&(this.jqDeferred=new f.Deferred);var i=this;setTimeout(function(){i.check()})}function u(e){this.img=e}function a(e){this.src=e,p[e]=this}var f=e.jQuery,l=e.console,c=l!==void 0,h=Object.prototype.toString;o.prototype=new t,o.prototype.options={},o.prototype.getImages=function(){this.images=[];for(var e=0,t=this.elements.length;t>e;e++){var n=this.elements[e];"IMG"===n.nodeName&&this.addImage(n);for(var r=n.querySelectorAll("img"),i=0,s=r.length;s>i;i++){var o=r[i];this.addImage(o)}}},o.prototype.addImage=function(e){var t=new u(e);this.images.push(t)},o.prototype.check=function(){function e(e,i){return t.options.debug&&c&&l.log("confirm",e,i),t.progress(e),n++,n===r&&t.complete(),!0}var t=this,n=0,r=this.images.length;if(this.hasAnyBroken=!1,!r)return this.complete(),void 0;for(var i=0;r>i;i++){var s=this.images[i];s.on("confirm",e),s.check()}},o.prototype.progress=function(e){this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded;var t=this;setTimeout(function(){t.emit("progress",t,e),t.jqDeferred&&t.jqDeferred.notify&&t.jqDeferred.notify(t,e)})},o.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var t=this;setTimeout(function(){if(t.emit(e,t),t.emit("always",t),t.jqDeferred){var n=t.hasAnyBroken?"reject":"resolve";t.jqDeferred[n](t)}})},f&&(f.fn.imagesLoaded=function(e,t){var n=new o(this,e,t);return n.jqDeferred.promise(f(this))}),u.prototype=new t,u.prototype.check=function(){var e=p[this.img.src]||new a(this.img.src);if(e.isConfirmed)return this.confirm(e.isLoaded,"cached was confirmed"),void 0;if(this.img.complete&&void 0!==this.img.naturalWidth)return this.confirm(0!==this.img.naturalWidth,"naturalWidth"),void 0;var t=this;e.on("confirm",function(e,n){return t.confirm(e.isLoaded,n),!0}),e.check()},u.prototype.confirm=function(e,t){this.isLoaded=e,this.emit("confirm",this,t)};var p={};return a.prototype=new t,a.prototype.check=function(){if(!this.isChecked){var e=new Image;n.bind(e,"load",this),n.bind(e,"error",this),e.src=this.src,this.isChecked=!0}},a.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},a.prototype.onload=function(e){this.confirm(!0,"onload"),this.unbindProxyEvents(e)},a.prototype.onerror=function(e){this.confirm(!1,"onerror"),this.unbindProxyEvents(e)},a.prototype.confirm=function(e,t){this.isConfirmed=!0,this.isLoaded=e,this.emit("confirm",this,t)},a.prototype.unbindProxyEvents=function(e){n.unbind(e.target,"load",this),n.unbind(e.target,"error",this)},o});(function(e){function a(t){e(this).touchSwipeLeft(t).touchSwipeRight(t)}function f(t){var n=e(this);if(!n.data("swipeLeft"))n.data("swipeLeft",t);if(!n.data("swipeRight"))c(n)}function l(t){var n=e(this);if(!n.data("swipeRight"))n.data("swipeRight",t);if(!n.data("swipeLeft"))c(n)}function c(e){e.unbindSwipe(true).bind(r,h)}function h(r){function m(e){l.unbind(n);if(a&&v){if(v-a<u&&Math.abs(c-p)>i&&Math.abs(h-d)<s){if(c>p){if(l.data("swipeLeft"))l.data("swipeLeft")("left")}else{if(l.data("swipeRight"))l.data("swipeRight")("right")}}}a=v=null}function g(e){if(a){f=e.originalEvent.touches?e.originalEvent.touches[0]:e;v=(new Date).getTime();p=f.pageX;d=f.pageY;if(Math.abs(c-p)>o)e.preventDefault()}}var a=(new Date).getTime(),f=r.originalEvent.touches?r.originalEvent.touches[0]:r,l=e(this).bind(n,g).one(t,m),c=f.pageX,h=f.pageY,p,d,v;if(l.data("stopPropagation"))r.stopImmediatePropagation()}var t,n,r,i=30,s=75,o=10,u=1e3;if("ontouchend"in document){t="touchend.cj_swp";n="touchmove.cj_swp";r="touchstart.cj_swp"}else{t="mouseup.cj_swp";n="mousemove.cj_swp";r="mousedown.cj_swp"}e.fn.touchSwipe=function(e,t){if(t)this.data("stopPropagation",true);if(e)return this.each(a,[e])};e.fn.touchSwipeLeft=function(e,t){if(t)this.data("stopPropagation",true);if(e)return this.each(f,[e])};e.fn.touchSwipeRight=function(e,t){if(t)this.data("stopPropagation",true);if(e)return this.each(l,[e])};e.fn.unbindSwipeLeft=function(){this.removeData("swipeLeft");if(!this.data("swipeRight"))this.unbindSwipe(true)};e.fn.unbindSwipeRight=function(){this.removeData("swipeRight");if(!this.data("swipeLeft"))this.unbindSwipe(true)};e.fn.unbindSwipe=function(e){if(!e)this.removeData("swipeLeft swipeRight stopPropagation");return this.unbind(r+" "+n+" "+t)}})(jQuery);(function(e,t,n){"use strict";var r=t.event,i=t.event.handle?"handle":"dispatch",s;r.special.smartresize={setup:function(){t(this).bind("resize",r.special.smartresize.handler)},teardown:function(){t(this).unbind("resize",r.special.smartresize.handler)},handler:function(e,t){var n=this,o=arguments;e.type="smartresize";if(s){clearTimeout(s)}s=setTimeout(function(){r[i].apply(n,o)},t==="execAsap"?0:100)}};t.fn.smartresize=function(e){return e?this.bind("smartresize",e):this.trigger("smartresize",["execAsap"])};t.Mason=function(e,n){this.element=t(n);this._create(e);this._init()};t.Mason.settings={isResizable:true,isAnimated:false,animationOptions:{queue:false,duration:500,complete:function(){var e=t(this);if(!e.hasClass("grid-brick")){if(t.fn.grid.defaults.lazyLoad){t.waypoints("refresh")}if(e.hasClass("grid-with-loading-boxes")){e.removeClass("grid-with-loading-boxes");e.addClass("completeAddingImages")}}}},gutterWidth:0,isRTL:false,isFitWidth:false,containerStyle:{position:"relative"}};t.Mason.prototype={_resized:false,_filterFindBricks:function(e){var t=this.options.itemSelector;return!t?e:e.filter(t).add(e.find(t))},_getBricks:function(e){var t=this._filterFindBricks(e).css({position:"absolute"}).addClass("grid-brick");return t},_create:function(n){this.options=t.extend(true,{},t.Mason.settings,n);this.styleQueue=[];var r=this.element[0].style;this.originalStyle={height:r.height||""};var i=this.options.containerStyle;for(var s in i){this.originalStyle[s]=r[s]||""}this.element.css(i);this.horizontalDirection=this.options.isRTL?"right":"left";var o=this.element.css("padding-"+this.horizontalDirection);var u=this.element.css("padding-top");this.offset={x:o?parseInt(o,10):0,y:u?parseInt(u,10):0};this.isFluid=this.options.columnWidth&&typeof this.options.columnWidth==="function";var a=this;setTimeout(function(){a.element.addClass("grid")},0);if(this.options.isResizable){t(e).bind("smartresize.grid",function(){a.resize()})}this.reloadItems()},_init:function(e){this._getColumns();this._reLayout(e)},option:function(e,n){if(t.isPlainObject(e)){this.options=t.extend(true,this.options,e)}},layout:function(e,t){for(var n=0,r=e.length;n<r;n++){this._placeBrick(e[n])}var i={};i.height=Math.max.apply(Math,this.colYs);if(this.options.isFitWidth){var s=0;n=this.cols;while(--n){if(this.colYs[n]!==0){break}s++}i.width=(this.cols-s)*this.columnWidth-this.options.gutterWidth}this.styleQueue.push({$el:this.element,style:i});var o=!this.isLaidOut?"css":this.options.isAnimated?"animate":"css",u=this.options.animationOptions;var a;var f=false;for(n=0,r=this.styleQueue.length;n<r;n++){a=this.styleQueue[n];o=!this.isLaidOut?"css":this.options.isAnimated?"animate":"css";var l=a.$el.hasClass("loading-box");if(l&&!this.element.hasClass("noSupportTransform")){o="css";f=true}else if(f){a.$el["css"](a.style,u)}a.$el.removeClass("loading-box");var c=a.$el.css("left");var h=a.$el.css("top");var p=a.style.left+"px";var d=a.style.top+"px";if(c==p&&h==d||l==true){a.$el.data("moving",false)}else{a.$el.data("moving",true)}a.$el[o](a.style,u)}this.styleQueue=[];if(t){t.call(e)}this.isLaidOut=true},_getColumns:function(){var e=this.options.isFitWidth?this.element.parent():this.element,t=e.width();this.columnWidth=this.isFluid?this.options.columnWidth(t):this.options.columnWidth||this.$bricks.outerWidth(true)||t;this.columnWidth+=this.options.gutterWidth;this.cols=Math.floor((t+this.options.gutterWidth)/this.columnWidth);this.cols=Math.max(this.cols,1)},_placeBrick:function(e){var n=t(e),r,i,s,o,u;r=Math.ceil(n.outerWidth(true)/this.columnWidth);r=Math.min(r,this.cols);if(r===1){s=this.colYs}else{i=this.cols+1-r;s=[];for(u=0;u<i;u++){o=this.colYs.slice(u,u+r);s[u]=Math.max.apply(Math,o)}}var a=Math.min.apply(Math,s),f=0;for(var l=0,c=s.length;l<c;l++){if(s[l]===a){f=l;break}}var h={top:a+this.offset.y};h[this.horizontalDirection]=this.columnWidth*f+this.offset.x;this.styleQueue.push({$el:n,style:h});var p=a+n.outerHeight(true),d=this.cols+1-c;for(l=0;l<d;l++){this.colYs[f+l]=p}},resize:function(){var e=this.cols;this._getColumns();if(this.isFluid||this.cols!==e){this._reLayout()}},_reLayout:function(e){var t=this.cols;this.colYs=[];while(t--){this.colYs.push(0)}this.layout(this.$bricks,e)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(e){this.reloadItems();this._init(e)},appended:function(e,t,n){if(t){this._filterFindBricks(e).css({top:this.element.height()});var r=this;setTimeout(function(){r._appended(e,n)},1)}else{this._appended(e,n)}},_appended:function(e,t){var n=this._getBricks(e);this.$bricks=this.$bricks.add(n);this.layout(n,t)},remove:function(e){this.$bricks=this.$bricks.not(e);e.remove()},destroy:function(){this.$bricks.removeClass("grid-brick").each(function(){this.style.position="";this.style.top="";this.style.left=""});var n=this.element[0].style;for(var r in this.originalStyle){n[r]=this.originalStyle[r]}this.element.unbind(".grid").removeClass("grid").removeData("grid");t(e).unbind(".grid")}};var o=function(t){if(e.console){e.console.error(t)}};t.fn.grid=function(r){var i=function(i){var s=t.extend({},t.fn.grid.defaults,r);if(r.lazyLoad!=n){t.fn.grid.defaults.lazyLoad=r.lazyLoad}if(r==n){r={}}r.isFitWidth=s.isFitWidth;r.isAnimated=s.isAnimated;r.itemSelector=".gbox";r.gutterWidth=s.horizontalSpaceBetweenThumbnails;var o=t(i).addClass("centered").addClass("grid-clearfix");var u=s.columnWidth;if(u=="auto"){r.columnWidth=function(e){var t=-999;for(var n=s.columns;n>=1;n--){if(t<s.columnMinWidth){t=(e-(n-1)*r.gutterWidth)/n|0}}o.find("div.gbox").width(t);return t}}else if(typeof u!="function"){r.columnWidth=function(e){var t=u;o.find("div.gbox").width(t);return t}}o.find("div.gbox").css("margin-bottom",s.verticalSpaceBetweenThumbnails);var a=function(){var e=document.createElement("div"),t="Khtml ms O Moz Webkit".split(" "),n=t.length;return function(r){if(r in e.style)return true;r=r.replace(/^[a-z]/,function(e){return e.toUpperCase()});while(n--){if(t[n]+r in e.style){return true}}return false}}();if(!a("transform")){o.addClass("noSupportTransform")}else{o.addClass("visible")}var f=null;var l=o.data("directory");var c=t("<div />").insertAfter(o);var h=function(){c.addClass("grid-loader").removeClass("grid-loadMore").html("")};var p=function(){c.removeClass("grid-loader")};var d=false;var v=function(){var e=0;for(var t in f){var n=f[t];e++}if(e>0){d=false;return true}else{return false}};var m=function(e){if(e){c.addClass("grid-loadMore").html("LOAD MORE")}else{c.removeClass("grid-loadMore").html("")}};var g=l;var y=g;var b=location.hash.substr(1);if(b!=""&&s.hashTag&&b!="*"){g+="/"+b;l+="/"+b}var w=function(e){if(e.substr(1,1)=="-"){return e.substr(2)}else{return e}};var E=function(e,t){var n="";if(t=="yes"){n="thumbnails/"}var r=e.split(/\.(?=[^.]*$)/)[0];var i="";if(r.indexOf("$$")!=-1){var s=r.split("$$");r=s[0];var o=s[1].split(":").join("/");o=o.split("|").join("/");i='data-url="'+o+'"'}r=w(r);var u='<div class="gbox" '+i+">"+'<img src="'+g+"/"+n+e+'" data-lightbox="'+g+"/"+e+'" />'+'<div class="image-caption">'+"<h4>"+r+"</h4>"+"</div>"+'<div class="lightbox-text">'+r+"</div>"+"</div>";return u};var S=function(e,t,n){var r="";if(n.thumb=="yes"){r="thumbnails/"}var i=w(e);var o='<i class="icon-folder-open icon-white" style="margin-right:5px;"></i>'+n.numFolders;var u='<i class="icon-picture icon-white" style="margin:0 5px 0 5px;"></i>'+n.numImages;if(!s.showNumFolder){o=""}if(!s.showNumImages){u=""}if(s.autoHideNumFolder&&n.numFolders==0){o=""}if(s.autoHideNumImages&&n.numImages==0){u=""}var a="";if(n.numImages==0&&t==""){a='style="height:200px"'}var f='<div class="gbox gridFolder" data-folder="'+e+'" '+a+">"+'<img src="'+g+"/"+e+"/"+r+t+'" />'+'<div class="gradient-container">'+'<div class="folder-info">'+'<div class="folder-name">'+i+"</div>"+'<div class="folder-count">'+o+u+"</div>"+"</div>"+"</div>"+"</div>";return f};var x=function(e){e.each(function(){var e=t(this).removeClass("noTransform");if(e.hasClass("grid-brick")){if(e.is(":hidden")){if(o.hasClass("noSupportTransform")){e.show()}else{e.show();if(e.data("moving")==false){e.animate(s.hiddenStyle,0);e.animate(s.visibleStyle,r.animOpts,function(){e.addClass("noTransform")})}else{e.animate(s.visibleStyle,0);e.addClass("noTransform")}}}else{e.animate(s.visibleStyle,r.animOpts,function(){e.addClass("noTransform")})}}})};var T=function(e){e=t(e).addClass("loading-box");e.css("margin-bottom",s.verticalSpaceBetweenThumbnails);o.append(e.hide());o.imagesLoaded(function(){e.hide().css({top:200,left:200});o.addClass("grid-with-loading-boxes");o.grid("reload");x(e);p();m(v());d=false})};var N=function(e){h();var t=new Array;if(s.foldersAtTop){for(var n in f){if(typeof f[n]=="string"){}else{t.push({image:n,thumb:f[n],folder:"yes"})}}for(var n in f){if(typeof f[n]=="string"){t.push({image:n,thumb:f[n],folder:"no"})}else{}}}else{for(var n in f){var r="yes";if(typeof f[n]=="string"){r="no"}t.push({image:n,thumb:f[n],folder:r})}}var i="";var o=0;while(o<e){if(o>=t.length)break;var u=t[o];var a=u["image"].split(/\.(?=[^.]*$)/)[0];if(a!="folderCover"){if(u["folder"]=="yes"){var l=u["thumb"].image;i+=S(u["image"],l,u["thumb"])}else{i+=E(u["image"],u["thumb"])}}delete f[u["image"]];o++}T(i)};var C=function(){if(c.hasClass("grid-loadMore")){N(s.imagesToLoad)}};c.on("click",function(){C()});if(s.lazyLoad){o.waypoint(function(e){var n=t(this);if(n.hasClass("completeAddingImages")){n.removeClass("completeAddingImages");if(c.hasClass("grid-loadMore")){C()}}},{context:e,continuous:true,enabled:true,horizontal:false,offset:"bottom-in-view",triggerOnce:false})}var k=t('<ul class="grid-breadcrumb grid-clearfix">'+"</ul>");if(s.showNavBar){k.insertBefore(o)}var L=function(){var e=g.split("/");var t="";var n="";var r="";var i="";for(var o=0;o<e.length;o++){if(n==""){n+=e[o]}else{n+="/"+e[o]}var u=w(e[o]);if(r==""){if(n!=y){continue}else{r="found it"}}if(n!=y){i+="/"+e[o]}if(o==e.length-1){t+='<li data-directory="'+n+'" class="active">'+u+"</li>"}else{t+='<li data-directory="'+n+'"><a>'+u+'</a><span class="divider">/</span></li>'}}if(s.hashTag&&i.substr(1)!=""){location.hash=i.substr(1)}else if(s.hashTag&&i.substr(1)==""){location.hash="*"}k.html(t)};L();var A=function(){o.find(".gbox").remove().end().css("height",0);c.removeClass("grid-loadMore").html("");L();h();t.getJSON("reader.php?directory="+encodeURIComponent(g)+"&albumsOrder="+s.albumsOrder+"&imagesOrder="+s.imagesOrder+"&folderCoverRandom="+s.folderCoverRandom,function(e){f=e;N(s.imagesToLoadStart)})};k.on("click","a",function(){g=t(this).parent("li").data("directory");A()});o.on("click","div.gridFolder",function(){var e=t(this).data("folder");g+="/"+e;A()});h();t.getJSON("reader.php?directory="+encodeURIComponent(l)+"&albumsOrder="+s.albumsOrder+"&imagesOrder="+s.imagesOrder+"&folderCoverRandom="+s.folderCoverRandom,function(e){f=e;N(s.imagesToLoadStart)});o.on("mouseenter.hoverdir, mouseleave.hoverdir","div.gbox",function(e){if(!s.caption)return;var r=t(this),i=e.type,o=r.find("div.image-caption"),u=O(r,{x:e.pageX,y:e.pageY}),a=M(u,r);var f=o.children("div.aligment");if(f[0]==n){var l=o.html();o.html("<div class='aligment'><div class='aligment'>"+l+"</div></div>")}if(i==="mouseenter"){if(s.captionType=="classic"){o.css({left:0,top:0});o.fadeIn(300);return}o.css({left:a.from,top:a.to});o.stop().show().fadeTo(0,1,function(){t(this).stop().animate({top:0,left:0},200,"linear")})}else{if(s.captionType=="classic"){o.css({left:0,top:0});o.fadeOut(300);return}if(s.captionType=="grid-fade"){o.fadeOut(700)}else{o.stop().animate({left:a.from,top:a.to},200,"linear",function(){o.hide()})}}});var O=function(e,t){var n=e.width(),r=e.height(),i=(t.x-e.offset().left-n/2)*(n>r?r/n:1),s=(t.y-e.offset().top-r/2)*(r>n?n/r:1),o=Math.round((Math.atan2(s,i)*(180/Math.PI)+180)/90+3)%4;return o};var M=function(e,t){var n,r;switch(e){case 0:if(!s.reverse){n=0,r=-t.height()}else{n=0,r=-t.height()}break;case 1:if(!s.reverse){n=t.width(),r=0}else{n=-t.width(),r=0}break;case 2:if(!s.reverse){n=0,r=t.height()}else{n=0,r=-t.height()}break;case 3:if(!s.reverse){n=-t.width(),r=0}else{n=t.width(),r=0}break}return{from:n,to:r}};var _=t("body");var D={interval:"none"};var P=0;var H=t('<div class="autoGrid-lightbox" />').appendTo(_);var B=t('<div class="autoGrid-nav" />').appendTo(H);var j=t('<div class="autoGrid-close" />').appendTo(B);var F=t('<i class="iconClose" />').appendTo(j);var I=t('<div class="autoGrid-play" />');if(s.lightboxPlayBtn){I.appendTo(B)}var q=t('<i class="iconPlay" />').appendTo(I);var R=t('<div class="autoGrid-lbcaption" />').appendTo(B).html("Here will go the text for the lightbox");var U=t('<div class="autoGrid-next" />').appendTo(B);var z=t('<i class="iconNext" />').appendTo(U);var W=t('<div class="autoGrid-prev" />').appendTo(B);var X=t('<i class="iconPrev" />').appendTo(W);var V=t('<div class="lightbox-timer" />').appendTo(H);var J=j.width();var K=3;if(s.lightboxPlayBtn)K=4;var Q=function(){var e=H.outerWidth(false);if(e<650){R.hide();U.css("width",e/K);W.css("width",e/K);I.css("width",e/K);j.css("width",e-e/K*(K-1))}else{R.show();U.css("width",J);W.css("width",J);I.css("width",J);j.css("width",J)}var t=H.find("img");var n=H.outerHeight(false)-B.outerHeight(false);t.css("max-height",n)};jQuery(e).resize(function(){Q()});var G=new Image;var Y=function(){G.onload=null;G=null;H.find(".lightbox-alignment").remove();H.find(".lightbox-alignment2").remove();H.find("img").remove()};var Z=function(){H.find(".lb-loader").remove()};var et=function(){H.append('<div class="lb-loader"/>')};H.attr("unselectable","on").css("user-select","none").on("selectstart",false);var tt=function(){V.stop(true,true).width(0)};var nt=function(){clearInterval(D.interval)};var rt=function(){if(s.lightBoxShowTimer==false)return;V.css({position:"absolute",bottom:0}).animate({width:"100%"},s.lightBoxPlayInterval,"linear",function(){tt()})};var it=false;var st=false;var ot=function(){D.interval=setTimeout(function(){ht()},s.lightBoxPlayInterval);rt()};var ut=function(){if(it&&st==false){tt();nt();ot()}};var at=t("<span />");var ft=function(e,r){Y();Z();et();var i=0;var o=0;if(r!=true){i=.9;o=s.lightBoxSpeedFx}if(s.lightBoxZoomAnim==false){i=1}var u=e;var a=u.data("lightbox");if(a==n){a=u.attr("src")}var f=u.siblings("div.lightbox-text").html();if(s.lightBoxText==false){f=""}var l="<div><div>"+f+"</div></div>";R.html(l);G=new Image;var c=t(G);var h=G;G.onload=function(){if(h!=G)return;Z();var e=t('<div class="lightbox-alignment"></div>').appendTo(H);var n=t('<div class="lightbox-alignment2"></div>').appendTo(e);n.append(c.css("margin-top",-B.outerHeight(false)).hide().scale(i));c.fadeIn(o).animate({scale:"1"},{duration:s.lightBoxSpeedFx,complete:function(){ut()}});Q()};G.src=a;at.stop(true);at=t(G)};var lt=false;o.on("click","div.gbox",function(){lt=true;var r=t(this);if(r.hasClass("gridFolder")){return}var i=r.data("url");if(i!=n){e.location.href="http://"+i;return}if(s.lightBox==false){return}st=false;P=o.find(".gbox").index(this);var u=r.children("img");B.animate({"margin-top":0},s.lightBoxSpeedFx);H.fadeIn(s.lightBoxSpeedFx);ft(u,true)});H.on("click","div",function(e){e.stopPropagation()});H.on("click","img",function(e){e.stopPropagation()});H.on("click",".lightbox-alignment",function(){ct()});H.on("click",".lightbox-alignment2",function(){ct()});H.on("click",function(){ct()});j.on("click",function(){ct()});var ct=function(){if(s.lightBoxStopPlayOnClose){I.removeClass("selected");it=false}lt=false;st=true;tt();nt();H.find(".lb-loader").remove();var e=0;if(s.lightBoxZoomAnim==false){e=1}var t=H.find("img").stop().show();B.animate({"margin-top":-B.outerHeight(false)},s.lightBoxSpeedFx);if(t[0]!=n){t.animate({scale:e},s.lightBoxSpeedFx,function(){H.fadeOut(100)})}else{H.fadeOut(100)}};var ht=function(){st=false;var e=o.find(".gbox");P+=1;if(P>=e.length){P=0}if(!e.eq(P).is(":visible")||e.eq(P).hasClass("gridFolder")){var t=P;for(var n=0;n<e.length;n++){t++;if(t>=e.length){t=0}var r=e.eq(t);if(r.is(":visible")&&r.hasClass("gridFolder")==false){P=t;break}}}var i=e.eq(P).children("img");ft(i)};var pt=function(){st=false;var e=o.find(".gbox");P-=1;if(P<0){P=e.length-1}if(!e.eq(P).is(":visible")||e.eq(P).hasClass("gridFolder")){var t=P;for(var n=0;n<e.length;n++){t--;if(t<0){t=e.length-1}var r=e.eq(t);if(r.is(":visible")&&r.hasClass("gridFolder")==false){P=t;break}}}var i=e.eq(P).children("img");ft(i)};U.on("click",function(){tt();nt();ht()});H.on("click","img",function(){tt();nt();ht()});W.on("click",function(){tt();nt();pt()});t(document).keyup(function(e){if(!s.lightboxKeyboardNav)return;if(e.keyCode=="37"){if(lt==false)return;tt();nt();pt()}if(e.keyCode=="39"){if(lt==false)return;tt();nt();ht()}if(e.keyCode==27){ct()}});if(s.swipeSupport){H.on("dragstart",function(e){e.preventDefault()});H.touchSwipeLeft(function(){tt();nt();ht()}).touchSwipeRight(function(){tt();nt();pt()})}if(s.lightBoxAutoPlay){I.addClass("selected");it=true}I.on("click",function(){i=t(this);if(i.hasClass("selected")){i.removeClass("selected");it=false;tt();nt()}else{i.addClass("selected");it=true;ot()}})};if(typeof r==="string"){var s=Array.prototype.slice.call(arguments,1);this.each(function(){var e=t.data(this,"grid");if(!e){o("cannot call methods on grid prior to initialization; "+"attempted to call method '"+r+"'");return}if(!t.isFunction(e[r])||r.charAt(0)==="_"){o("no such method '"+r+"' for grid instance");return}e[r].apply(e,s)})}else{this.each(function(){var e=t.data(this,"grid");if(e){e.option(r||{});e._init()}else{i(this);t.data(this,"grid",new t.Mason(r,this))}})}return this};t.fn.grid.defaults={imagesOrder:"byName",albumsOrder:"none",folderCoverRandom:true,foldersAtTop:true,showNumFolder:true,showNumImages:true,autoHideNumFolder:true,autoHideNumImages:false,isFitWidth:true,lazyLoad:true,showNavBar:true,imagesToLoadStart:15,imagesToLoad:5,horizontalSpaceBetweenThumbnails:5,verticalSpaceBetweenThumbnails:5,columnWidth:"auto",columns:5,columnMinWidth:195,isAnimated:true,caption:true,captionType:"grid",lightBox:true,lightboxKeyboardNav:true,lightBoxSpeedFx:500,lightBoxZoomAnim:true,lightBoxText:true,lightboxPlayBtn:true,lightBoxAutoPlay:false,lightBoxPlayInterval:4e3,lightBoxShowTimer:true,lightBoxStopPlayOnClose:false,hashTag:false,swipeSupport:false,hiddenStyle:{opacity:0,scale:.001},visibleStyle:{opacity:1,scale:1}}})(window,jQuery)



